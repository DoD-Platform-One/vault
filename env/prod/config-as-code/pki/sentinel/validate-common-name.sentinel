validate_common_name = func() {
	if "common_name" in keys(request.data) {

		# disallow wildcard certs
		if request.data.common_name is "*.dso.mil" or "*.il2.dso.mil" or "*.il4.dso.mil" or "*.il5.dso.mil" {
			print("Wildcard certificates are not allowed")
			return false
        }
        # if request.path is "pki/int/p1_int/sign/p1-leaf-cert" and request.data.common_name is "DoD P1 Ironbank Public CA" {
        #     return true
        # }
        # if request.path is "pki/int/p1_int/sign/p1-leaf-cert" and request.data.common_name is not "DoD P1 Ironbank Public CA" {
        #         print("this is not a valid certificate endpoint")
        #         return false
        # }

	return true
    }
}

main = rule {
	validate_common_name()
}
